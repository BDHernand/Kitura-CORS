# Travis CI build file for Kitura-CORS.
# Kitura runs on OS X and Linux (Ubuntu).
# See the following URLs for further details on Travis CI
# https://docs.travis-ci.com/user/customizing-the-build/
# https://docs.travis-ci.com/user/docker/
# https://docs.travis-ci.com/user/multi-os/

# whitelist (branches that should be built)
branches:
  only:
    - master
    - /^issue.*$/

notifications:
  slack:
    secure: "R2HbLUbIIExCKsPNaEdZqwKw+X3ITAyjn6qYmrcCAuZ+UREZfEZCoiXrxto6qGz5J1Rb9Hni/9KXBlOIWtTwWM6x8w/A0vm8tlzFVE7+MSCWq+mSJTVtfTVI/A0RMp4/7h09XGGqmDYqLf2X1RVi9yIbQpL3UfIPJgTKw6CJI4cNZ61eXCEj2GPoVYYoVqpQ++/MGO4fZkLVuKVmk5a7KLrnWf2a+fN0bgArNmsIsjxtPZt3p36siCNfnyS+Rs28DehFJbOX99kj8KO6O8kqfj4lMgeFQV9CoLkseRGBN7hVYKEmfl/bZk2Bscc2yWOygoLyWSChGpI1hx6ZHGtWffAb3aI3o2jjP003w5GmuV9Byr62uBtsH79mEpRO94hKiHCeXlDnbvL+7xyXSBLGKEh5Vbxdi8HhaCiKkZyj/ZbQwyjZhv9tBl3SqJjosVxPioaY4mLN/tm6pMFKujQoBerZU73MNn5A+v/C7BJzqtnEkfsDMe8+FK4nhgtlUVQw/f25XOor2iR60a9xOupayqrNft8bE0PYHrO0Q5IcYzhPb5lerk0INScvEbHit4hmQSA/PFR5t5IFDveNarlnUrStSnl0pY1b3c+YCjmcxavMHusyZ7MAW19pCd2GA9MNd5QK1OugLyolByxjMwoX1dH90guvy1TJQ2Dwq8KUB8g="

matrix:
  include:
    - os: linux
      services: docker
      sudo: required
    - os: osx
      osx_image: xcode8
      sudo: required

before_install:
  - git submodule init
  - git submodule update
  - cd Kitura-Build && git checkout master && cd $TRAVIS_BUILD_DIR

script:
  - echo ">> Let's build and test the '$TRAVIS_BRANCH' branch for Kitura-CORS."
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then ./Kitura-Build/run_kitura_ubuntu_container.sh $TRAVIS_BRANCH $TRAVIS_BUILD_DIR Kitura; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then ./Kitura-Build/build_kitura_package.sh ; fi
  - echo ">> Build and tests completed. See above for status."
